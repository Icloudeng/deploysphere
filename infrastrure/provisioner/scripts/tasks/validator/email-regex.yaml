- debug:
    var: email

- set_fact:
    email_regex: ^[\w+\-.]+@[a-z\d\-]+(\.[a-z]+)*\.[a-z]+$

- name: Ensure email variable is set
  assert:
    that:
      - email is defined and email != ''
    fail_msg: "Email variable is not set or is empty."
    quiet: yes

- name: Ensure email variable satisfies email regex
  assert:
    that:
      - email | regex_search(email_regex)
    fail_msg: "Email variable does not satisfy the Email address format."
    quiet: yes
